    service_connect_configuration = service_attrs.enable_service_connect ? (
      {
        namespace = local.service_discovery_namespace_arn
        service   = {
          port_name      = tostring(values(service_attrs.container_definitions)[0].container_port) # Usar o container_port como port_name
          discovery_name = keys(service_attrs.container_definitions)[0] # Usar o nome do container como discovery_name
          client_alias = { # <--- REMOVIDOS OS COLCHETES AQUI!
            port     = values(service_attrs.container_definitions)[0].container_port
            dns_name = keys(service_attrs.container_definitions)[0] # Usar o nome do container como dns_name
          }
        }
      }
    ) : null

service_connect_configuration = service_attrs.service_connect_configuration

# outputs.tf

output "debug_service_connect_configurations" {
  description = "Debug output for service_connect_configuration of each ECS service."
  value       = {
    for service_name, service_config in local.ecs_service_configs :
    service_name => service_config.service_connect_configuration
  }
}
